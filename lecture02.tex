\chapter{Теория множеств}

\section{О наивной теории множеств}

У любого человека есть некоторое интуитивное представление о том, что такое
множество: это некоторая коллекция объектов, называемых \textit{элементами}
множества.

\begin{defn}
  $x \in X$ означает ``$x$ является элементом множества $X$''.
\end{defn}
\begin{defn}
  $\{x_1,\ldots,x_n\}$ --- обозначение множества, в точности состоящего из
  элементов $x_1,\ldots,x_n$.
\end{defn}

(Заметим, что ничего не мешает множествам самим быть элементами некоторых других
множеств: $0\in\mathbb{N}\in\{\mathbb{N}\}\in\ldots$)

Также естественно считать, что множества полностью определяются тем, какие
элементы в них содержатся; также это можно понимать как ``в множествах нет
дополнительной структуры''; это называется

\begin{ax}[Аксиома экстенсиональности]
  Множества равны тогда и только тогда, когда в них содержатся одни и те же
  элементы.
  \[
    A=B\;\Longleftrightarrow\;\forall x.(x\in A)\equiv(x\in B).
  \]
\end{ax}

Однако недаром теория множеств, которую мы здесь вводим, называется ``наивной''
--- оказывается, интуитивное представление о множествах может завести нас в
ловушку, в которую попались логики начала XX века, пытаясь показать
непротиворечивость математики. Проблемы начинаются, когда мы начинаем
отождествлять множество $X$ и предикат принадлежности к нему $\in X$, т.е. когда
мы вводим следующую аксиому:

\begin{ax*}[Аксиома неограниченного выделения]
  Для любого условия $\varphi(x)$ на объектах существует множество объектов,
  удовлетворяющих этому условию. Оно обозначается $\{x\;|\;\varphi(x)\}$.
\end{ax*}

(Обратите внимание, что мы её не нумеруем --- для того, чтобы отделить её
от остальных аксиом и теорем, которыми мы в действительности пользуемся.)

Пользуясь введёнными на данный момент определениями и аксиомами, мы уже можем
вывести противоречие. Такие противоречия, которые выводятся из на первый взгляд
невинных предположений, называются \textit{парадоксами}; их особая ценность
заключается в том, что они обнажают несовершенство рассуждений: либо ошибочность
предположений, либо некорректность самого хода рассуждений.

Итак, \textit{парадокс Рассела}. Формально его можно оформить как теорему:

\begin{thm}[Парадокс Рассела]
  \quad\\Наивная теория множеств противоречива.
\end{thm}
\begin{proof}По шагам.
\begin{enumerate}
  \item Рассмотрим следующие объекты $x$: $x\in x$. Такие иксы называются
    ``самосодержащими''.
  \item В свою очередь, если $x\not\in x$, то $x$ называется
    ``несамосодержащим''.
  \item По аксиоме неограниченного выделения, совокупность
    \[R = \{x\;|\;x\not\in x\}\] является множеством. Другими словами,
    существует множество несамосодержащих множеств, называющееся $R$.
  \item По закону исключённого третьего из алгебры логики, должно быть верно
    ровно одно из $R\in R$ либо $R\not\in R$. Однако рассмотрим оба случая:
    \begin{itemize}
      \item Пусть $R\in R$, то есть $R$ является несамосодержащим. Но тогда по
        определению несамосодержащих выполнено $R\not\in R$.
      \item Пусть $R\not\in R$, то есть $R$ не является несамосодержащим. Но
        тогда он самосодержащий, то есть $R\in R$.
    \end{itemize}
  \item Рассмотрев оба случая, пришли к противоречию. Значит, исходные
    предположения также противоречивы.
\end{enumerate}
\end{proof}
\begin{rem*}
  Точно такие же парадоксы содержатся и в естественном языке: рассмотрим понятие
  ``несамоописывающий''. Является ли оно самоописывающим?
\end{rem*}
\begin{rem*}
  Пересказанный в виде логической задачи, парадокс Расселя также называется
  парадоксом брадобрея: <<Добрый брадобрей бреет тех и только тех жителей
  города, кто не бреется сам. Кто бреет брадобрея?>>
\end{rem*}

Найденная в самых основаниях математики зияющая дыра парадокса породила
отдельную область логических исследований, занимающаяся вопросами
корректности доказательств и, в целом, логическими основаниями математики.
В качестве решения проблемы было предложено сразу несколько решений; новые
появляются до сих пор. Однако мы не будем изучать их все, а остановимся на том,
которое победило в конечном счёте и на данный момент доминирует.
О нём --- далее.

\section{Теория множеств Цермело-Френкеля}

Ключевая идея теории ZF (краткое название теории множеств Цермело-Френкеля) ---
просто нужно быть осторожнее в рассуждениях о том, является ли что-то множеством
или нет. В частности, не бывает ``слишком больших'' множеств (содержащих вообще
всё) и самосодержащих.

Как и в наивной теории множеств, в ZF конечные наборы $\{x_1,\ldots,x_n\}$
являются множествами, а равные множества --- в точности те, которые содержат
одинаковые элементы. Кроме этого, в ZF есть:

\begin{ax}[Аксиома (ограниченного) выделения]
  Для любого множества $A$ и условия $\varphi(x)$ на его объектах существует
  множество объектов из $A$, удовлетворяющих этому условию. Оно обозначается
  $\{x\in A\;|\;\varphi(x)\}$.
\end{ax}

Заметим, что, хоть это и является ограничением исходной проблематичной аксиомы,
мы всё ещё можем восстановить парадокс Рассела, если в качестве $A$ мы возьмём
некоторое ``множество всех множеств'' $U$. К счастью, в ZF такого $U$ не
существует: это гарантируется \textit{аксиомой регулярности}, которую мы здесь
не приводим, а вместо этого приводим два полезных следствия из неё:

\begin{impl}
  Множество не может содержать само себя: $\forall x.x\not\in x$. В частности,
  не существует множества всех множеств $U$, поскольку для него было бы
  выполнено $U\in U$.
\end{impl}
\begin{impl}
  Не бывает бесконечно убывающей цепочки множеств
  $\ldots\in x_3\in x_2\in x_1\in x_0$.
\end{impl}
(Заметьте, что возрастающие цепочки разрешены:
$0\in\mathbb{N}\in\{\mathbb{N}\}\in\ldots$)

Из аксиомы выделения также следует существование множества, являющегося
пересечением двух других множеств:

\begin{defn}
  \textit{Пересечением} множеств $A$ и $B$ называется множество
  $A\cap B:=\{x\in A\;|\;x\in B\}$.
\end{defn}
\begin{impl}
  В пересечении $A$ и $B$ содержатся в точности те элементы, которые содержатся
  и в $A$, и в $B$.
  \[x\in A\cap B\;\Longleftrightarrow\;x\in A\land x\in B.\]
\end{impl}
Также можно встретить такую запись: $A\cap B=\{x\;|\;x\in A\land x\in B\}$. Как
мы уже знаем, формально она некорректна, но поскольку ясно, как построить такое
множество с помощью аксиомы \textit{ограниченного} выделения, такой записью
пользоваться можно.

Из \textit{аксиомы объединения} (опять же, здесь мы её не приводим) следует
существование множества, являющегося объединением двух и более множеств (опять
же, впереди не вполне корректная, но более простая и наглядная запись):

\begin{defn}[Объединение множеств]
  $A\cup B:=\{x\;|\;x\in A\lor x\in B\}$.
\end{defn}
\begin{defn}[Объединение семейства множеств]
  Пусть дана последовательность множеств $A_1,\ldots,A_n,\ldots$. Существует
  множество, являющееся их объединением:
  \[\bigcup_{i=1}^\infty A_i = \{x\;|\;\exists i.\;x\in A_i\}
  \]
\end{defn}

Из \textit{аксиомы бесконечности} следует, что совокупность натуральных чисел
$\mathbb{N}$ является множеством; из \textit{аксиомы степени} --- что
совокупность подмножеств множества $A$ тоже является множеством:

\begin{defn}
  Множество $S$ \textit{является подмножеством} множества $A$, если все элементы
  $S$ также являются элементами $A$:
  \[
    S\subseteq A\;:\Longleftrightarrow\;\forall x.\;x\in S\to x\in A.
  \]
\end{defn}
\begin{ax}[Аксиома степени aka аксиома булеана]
  Для любого множества $X$ существует множество всех его подмножеств $2^X$,
  также обозначаемое $\mathcal{P}(X)$:
  \[
    2^X := \mathcal{P}(X) := \{S\;|\;S\subseteq X\}.
  \]
\end{ax}

Кроме этого, из аксиом ZF выводится существование следующих разновидностей
множеств:

\begin{defn}[Декартово произведение]
  Для любых двух множеств $A$ и $B$ существует множество $A\times B$
  упорядоченных пар, где первая компонента пары --- из множества $A$, а вторая
  --- из множества $B$:
  \[
    A\times B\;:=\;\{(a, b)\;|\;a\in A\land b\in B\}.
  \]
\end{defn}
\begin{defn}
  Для любых двух множеств $A$ и $B$ существует множество $B^A$ всюду
  определённых функций из $A$ в $B$ (про функции мы поговорим подробнее
  позднее):
  \[
    B^A\;:=\;\{f\;|\;f:A\to B\}.
  \]
\end{defn}

\subsection{Разность, дополнение и универсум}

Ещё одно определение уже знакомого вам из школы множества:

\begin{defn}[Разность множеств]
  $A\setminus B\;:=\;\{x\in A\;|\;x\not\in B\}$.
\end{defn}

Кроме этого, часто также рассматривают следующую операцию

\begin{defn}[Дополнение множества]
  $\overline{A}\;:=\;U\setminus A$.
\end{defn}

Где $U$ --- некоторый загадочный ``универсум'', содержащий кроме $A$ вообще
``всё''. Как мы знаем, множества всех множеств не существует; что же такое $U$?

На самом деле, конкретное определение $U$ зависит от задачи. В какой-нибудь
конкретной области математики (математический анализ, линейная алгебра,
комбинаторика...) за $U$ можно взять предметную область:

\begin{itemize}
  \item В математическом анализе --- множество действительных чисел
    $\mathbb{R}$, объединённое со всеми, получаемыми из него с помощью операций,
    описанных в предыдущей секции;
  \item В линейной алгебре --- аналогично, но для произвольного поля
    $\mathbb{F}$, над которым производятся вычисления;
  \item В комбинаторике --- аналогично, но для конечных подмножеств натуральных
    чисел.
\end{itemize}

В случае, если конкретная предметная область не определена --- например, если
исследуется истинность высказываний про произвольные множества --- универсумом
следует взять множество, содержащее все элементы, которые могут рассматриваться
в доказательстве.

\section{Аксиома выбора}

Кроме исходных аксиом ZF, в математике часто приходится прибегать к так
называемой \textit{аксиоме выбора}.

\begin{defn}
  \textit{Семейством} множеств $F_1,\ldots,F_n,\ldots$ называется множество $F$,
  их содержащее как элементы: $F_1\in F$,\dots,$F_n\in F$,\dots
\end{defn}

(В семействе может быть множеств гораздо больше, чем натуральных чисел; более
того, множества в семействе могут быть вообще никак не пронумерованы.)

\begin{ax}[Аксиома выбора aka AoC]
  Для всякого семейства $F$ непустых множеств существует функция
  $\verb|choice|(F)$, каждому множеству $X$ из семейства сопоставляющая элемент
  этого множества. Другими словами,
  \[\verb|choice|(F) : F \to \bigcup_{X\in F} X\]
  \[\verb|choice|(F)(X) \in X\]
\end{ax}

В наивном понимании вещей (если, например, представлять множества как просто
коллекции объектов) AoC, конечно, выполняется --- и, действительно, для
достаточно маленьких семейств $F$ функцию $\verb|choice|(F)$ можно построить
благодаря другим аксиомам, не прибегая к AoC. Но в применении к более крупным
семействам она позволяет получать какие-то уж совсем странные следствия:
удваивать сферы, упорядочивать произвольные множества,\dots. Может показаться,
что такая странная аксиома должна приводить к противоречиям, однако таковые до
сих пор не были найдены.

Учитывая полезность AoC для доказательства фундаментальных результатов в теории
порядков и в коммутативной алгебре, её всё-таки используют; система аксиом ZF
вместе с AoC называется ZF+C либо просто ZFC.

\subsection{Непротиворечивость ZF(C), теорема о неполноте}

Всё же возникает вопрос: мы узнали, что наивная теория множеств противоречива.
Можем ли мы доказать, что ZF непротиворечива?

К сожалению, нет: из \textit{первой Теоремы Гёделя о неполноте} следует, что в
любой теории, позволяющей формулировать и доказывать некоторые достаточно
простые факты о натуральных числах, нельзя доказать собственную
непротиворечивость; в нашем случае это значит, что, пользуясь стандартным
аппаратом теории множеств, непротиворечивость самого аппарата по себе доказать
нельзя, для этого необходимы некоторые более сильные предположения.

Но об этом переживать не стоит: во-первых, есть риск из программиста
превратиться в логика или философа; во-вторых, учитывая долгую историю
математики, в ходе которой противоречия так и не были найдены либо устранялись
без серьёзных потерь, вероятность того, что Ваше доказательство вдруг окажется
некорректным, очень и очень мала.

Однако если и извлечь урок из всей этой истории, то следующий: чем на меньшее
количество дополнительных предположений опирается доказательство, тем лучше
(тем меньше шанс, что какие-то предположения окажутся неверны); чем проще
доказательство, тем оно лучше (поскольку его будет проще поправить, если
какие-то предположения окажутся неверны).
